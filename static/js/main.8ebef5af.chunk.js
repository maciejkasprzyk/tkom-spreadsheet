(this["webpackJsonptkom-spreadsheet"]=this["webpackJsonptkom-spreadsheet"]||[]).push([[0],{15:function(e,t,n){e.exports={Spreadsheet:"Spreadsheet_Spreadsheet__2MlAU",focus:"Spreadsheet_focus__2PRei",cell:"Spreadsheet_cell__1_ob1",error:"Spreadsheet_error__2OBGk"}},20:function(e,t,n){e.exports={Editor:"Editor_Editor__3K0No",Top:"Editor_Top__3e9Hb",customFileUpload:"Editor_customFileUpload__SpF0p",Bottom:"Editor_Bottom__MdgSJ"}},32:function(e,t,n){!function(){function t(e,t,n){this.lexer=e,this.ws=t,this.end=n}function r(e,t){return 0===e.lastIndexOf(t,0)}function s(e){for(var t="",n=0;n<e.length;++n){for(var r=e.charCodeAt(n),s="",a=0;a<4;++a){var o=r%16;r/=16;var i=o<10?48:87;s=String.fromCharCode(o+i)+s}t+="\\u"+s}return'"'+t+'"'}t.prototype.next=function(){try{return this.ignoreWhiteSpaceNext()}catch(e){throw new(n(9).UserError)(e.message)}},t.prototype.ignoreWhiteSpaceNext=function(){for(var e;(e=this.indentedNext())&&e.type===this.ws;);return e},t.prototype.indentedNext=function(){for(;0===this.tokens.length;)this.generateMoreTokens();return this.tokens.shift()},t.prototype.generateMoreTokens=function(){var e=this.lexer.next(this);if(!e)return this.changeIndent(""),void this.tokens.push(e);this.afterNewLine?(this.afterNewLine=!1,e.type===this.ws?this.changeIndent(e.value,e.col,e.line,e.offset):(this.changeIndent("",e.col,e.line,e.offset),this.tokens.push(e))):this.tokens.push(e),this.afterNewLine=e.type===this.end},t.prototype.changeIndent=function(e,t,n,a){for(;e!==this.indents[this.indents.length-1];){var o=this.indents[this.indents.length-1];if(r(e,o))return this.tokens.push({type:"indent",text:e,value:e,lineBreaks:0,col:t,line:n,offset:a}),void this.indents.push(e);if(!r(o,e))throw o=s(o),e=s(e),Error("Indentations cannot be compared: "+o+" and "+e+".");this.tokens.push({type:"dedent",text:e,value:e,lineBreaks:0,col:t,line:n,offset:a}),this.indents.pop()}},t.prototype.save=function(){return this.lexer.save()},t.prototype.reset=function(e,t){this.lexer.reset(e,t),this.indents=[""],this.tokens=[],this.afterNewLine=!0},t.prototype.formatError=function(e){return this.lexer.formatError(e,"Invalid syntax")},t.prototype.has=function(e){return this.lexer.has(e)},e.exports?e.exports=t:window.IndentedLexer=t}()},33:function(e,t,n){e.exports={App:"App_App__rq8wc"}},37:function(e,t,n){e.exports=n(471)},42:function(e,t,n){},471:function(e,t,n){"use strict";n.r(t);var r=n(0),s=n.n(r),a=n(17),o=n.n(a),i=(n(42),n(8)),c=n(14),l=n(15),u=n.n(l),p=n(21),f=n.n(p),b=n(9),m=f.a.mark(h);function h(){var e,t,n;return f.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:e=function(e){return String.fromCharCode(e.charCodeAt(0)+1)},t=["A"];case 2:return r.next=5,t.slice().reverse().join("");case 5:t[n=0]=e(t[n]);case 7:if(!(t[n].charCodeAt(0)>"Z".charCodeAt(0))){r.next=16;break}if(t[n]="A",!(++n>=t.length)){r.next=13;break}return t.push("A"),r.abrupt("break",16);case 13:t[n]=e(t[n]),r.next=7;break;case 16:r.next=2;break;case 18:case"end":return r.stop()}}),m)}function y(e){for(var t=function(e){var t=/([a-zA-Z]+)([0-9]+)/.exec(e);return[t[1],t[2]]}(e),n=Object(i.a)(t,2),r=n[0],s=n[1],a=parseInt(s)-1,o=-1,c=0;c<r.length;c++)o+=1,o*="Z".charCodeAt(0)-"A".charCodeAt(0)+1,o+=r[c].charCodeAt(0)-"A".charCodeAt(0);return{x:o,y:a}}function v(e,t,n){var r=n.value;return"function"===typeof r&&(n.value=function(){try{for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.apply(this,t)}catch(o){if("UserError"===o.name){var s=/.*line (\d*).*col (\d*)/gm,a=s.exec(o.message);throw null===a&&(o.message="Execution error at line "+this.line+" col "+this.col+":\n"+o.message),o}throw o}}),n}var d=n(36);var g,O,x,j,$=Object(c.a)((function(e){var t=function(e){var t=Object(r.useState)(e),n=Object(i.a)(t,2),s=n[0],a=n[1];return[function(e){return s&&s.x===e.x&&s.y===e.y},function(e){a(null==e?null:{x:e.x,y:e.y})}]}(),n=Object(i.a)(t,2),a=n[0],o=n[1],c=function(e){13===e.keyCode&&e.target.blur()},l=h();return s.a.createElement("div",{className:u.a.Spreadsheet},s.a.createElement(d.a,{id:"tooltip",getContent:function(t){return function(t){if(null===t)return null;var n=t.split(" "),r=Object(i.a)(n,2),s=r[0],a=r[1];s=parseInt(s),a=parseInt(a);var o=e.cells[s][a];return null!==o.error?o.error:null!==o.value?o.value:null}(t)}}),s.a.createElement("table",null,s.a.createElement("thead",null,s.a.createElement("tr",null,s.a.createElement("th",null),Array(e.x).fill(0).map((function(e,t){return s.a.createElement("th",{key:t},l.next().value)})))),s.a.createElement("tbody",null,e.cells.map((function(t,n){return s.a.createElement("tr",{key:n},s.a.createElement("th",null,n+1),t.map((function(t,r){return s.a.createElement("td",{style:{backgroundColor:t.background},onClick:function(e){return function(e,t){o(t)}(0,t)},key:r,"data-tip":n+" "+r,"data-for":"tooltip"},a(t)?s.a.createElement("input",{onKeyDown:c,onFocus:function(e){return function(e,t){e.target.value=t.formula?t.formula:t.value,e.target.parentNode.classList.add(u.a.focus)}(e,t)},onBlur:function(n){return function(t,n){e.onCellSet(n.x,n.y,t.target.value),t.target.parentNode.classList.remove(u.a.focus),a(n)&&o(null)}(n,t)},autoFocus:!0}):s.a.createElement("div",{className:"".concat(u.a.cell," ").concat(t.error?u.a.error:"")},t.error?t.error:t.value))})))})))))})),k=n(11),w=n(1),S=n(2),E=n(10),C=(n(25),n(19)),q=n(5),_=n(3),A=n(4),N=function(){function e(t){var n=t.value,r=t.type,s=t.text,a=t.offset,o=t.line,i=t.col;Object(w.a)(this,e),this.value=n,this.type=r,this.text=s,this.offset=a,this.line=o,this.col=i}return Object(S.a)(e,[{key:"findCellsReferenced",value:function(t){var n=[];for(var r in this)this[r]instanceof e&&(n=n.concat(this[r].findCellsReferenced(t)));return n}},{key:"unParse",value:function(e){return this.text}},{key:"exec",value:function(e){throw new b.UserError("Executing non executable")}}]),e}(),R=function(e){function t(e,n,r){var s;return Object(w.a)(this,t),(s=Object(q.a)(this,Object(_.a)(t).call(this,r))).left=e,s.right=n,s}return Object(A.a)(t,e),Object(S.a)(t,[{key:"unParse",value:function(e){return"( "+this.left.unParse(e)+" "+this.text+" "+this.right.unParse(e)+" )"}}]),t}(N),I=function(e){function t(){return Object(w.a)(this,t),Object(q.a)(this,Object(_.a)(t).apply(this,arguments))}return Object(A.a)(t,e),Object(S.a)(t,[{key:"exec",value:function(e){return this.left.exec(e)+this.right.exec(e)}}]),t}(R),P=function(e){function t(){return Object(w.a)(this,t),Object(q.a)(this,Object(_.a)(t).apply(this,arguments))}return Object(A.a)(t,e),Object(S.a)(t,[{key:"exec",value:function(e){return this.left.exec(e)-this.right.exec(e)}}]),t}(R),U=function(e){function t(){return Object(w.a)(this,t),Object(q.a)(this,Object(_.a)(t).apply(this,arguments))}return Object(A.a)(t,e),Object(S.a)(t,[{key:"exec",value:function(e){return this.left.exec(e)*this.right.exec(e)}}]),t}(R),L=function(e){function t(){return Object(w.a)(this,t),Object(q.a)(this,Object(_.a)(t).apply(this,arguments))}return Object(A.a)(t,e),Object(S.a)(t,[{key:"exec",value:function(e){return this.left.exec(e)/this.right.exec(e)}}]),t}(R),F=function(e){function t(){return Object(w.a)(this,t),Object(q.a)(this,Object(_.a)(t).apply(this,arguments))}return Object(A.a)(t,e),Object(S.a)(t,[{key:"exec",value:function(){return this.value}}]),t}(N),B=function(e){function t(){return Object(w.a)(this,t),Object(q.a)(this,Object(_.a)(t).apply(this,arguments))}return Object(A.a)(t,e),Object(S.a)(t,[{key:"exec",value:function(e){return-this.operand.exec(e)}}]),t}(function(e){function t(e,n){var r;return Object(w.a)(this,t),(r=Object(q.a)(this,Object(_.a)(t).call(this,n))).operand=e,r}return Object(A.a)(t,e),t}(N)),T=function(e){function t(e,n,r){var s;return Object(w.a)(this,t),(s=Object(q.a)(this,Object(_.a)(t).call(this,r))).cell1=e,s.cell2=n,s}return Object(A.a)(t,e),Object(S.a)(t,[{key:"getCells",value:function(e){return e.getCellsByRange(this.cell1,this.cell2)}},{key:"exec",value:function(e){return this}},{key:"findCellsReferenced",value:function(e){return e.getCellsByRange(this.cell1,this.cell2)}},{key:"unParse",value:function(e){return e.getCell(this.cell1.x,this.cell1.y).label+":"+e.getCell(this.cell2.x,this.cell2.y).label}}]),t}(N),D=function(e){function t(e,n,r){var s;return Object(w.a)(this,t),(s=Object(q.a)(this,Object(_.a)(t).call(this,r))).identifier=e,s.args=n,s}return Object(A.a)(t,e),Object(S.a)(t,[{key:"exec",value:function(e){var t=e.getFunction(this.identifier);if(this.args.length!==t.args.length)throw new b.UserError("".concat(t.args.length," params function called with ").concat(this.args.length," params."));var n=[],r=!0,s=!1,a=void 0;try{for(var o,i=this.args[Symbol.iterator]();!(r=(o=i.next()).done);r=!0){var c=o.value;n.push(c.exec(e))}}catch(v){s=!0,a=v}finally{try{r||null==i.return||i.return()}finally{if(s)throw a}}e.newScope();for(var l=0;l<this.args.length;l++)n[l]instanceof T&&e.setReference(t.args[l].identifier,n[l]),e.setVariable(t.args[l].identifier,n[l]);var u=!0,p=!1,f=void 0;try{for(var m,h=t.block[Symbol.iterator]();!(u=(m=h.next()).done);u=!0){var y=m.value;try{y.exec(e)}catch(d){if("returnHandler"===d.name)return e.popScope(),d.result;throw e.popScope(),d}}}catch(v){p=!0,f=v}finally{try{u||null==h.return||h.return()}finally{if(p)throw f}}e.popScope()}},{key:"unParse",value:function(e){var t=[],n=!0,r=!1,s=void 0;try{for(var a,o=this.args[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var i=a.value;t.push(i.unParse(e))}}catch(c){r=!0,s=c}finally{try{n||null==o.return||o.return()}finally{if(r)throw s}}return this.identifier+"("+t.join(",")+")"}},{key:"findCellsReferenced",value:function(e){var t=[],n=!0,r=!1,s=void 0;try{for(var a,o=this.args[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var i=a.value;t=t.concat(i.findCellsReferenced(e))}}catch(c){r=!0,s=c}finally{try{n||null==o.return||o.return()}finally{if(r)throw s}}return t}}]),t}(N),z=(g=function(e){function t(e,n){var r;return Object(w.a)(this,t),(r=Object(q.a)(this,Object(_.a)(t).call(this,n))).identifier=e,r}return Object(A.a)(t,e),Object(S.a)(t,[{key:"exec",value:function(e){var t=e.getReference(this.identifier);return void 0!==t?t.exec(e):e.getVarByName(this.identifier).value}}]),t}(N),Object(E.a)(g.prototype,"exec",[v],Object.getOwnPropertyDescriptor(g.prototype,"exec"),g.prototype),g),V=(O=function(e){function t(e,n,r){var s;return Object(w.a)(this,t),(s=Object(q.a)(this,Object(_.a)(t).call(this,r))).x=e,s.y=n,s}return Object(A.a)(t,e),Object(S.a)(t,[{key:"exec",value:function(e){return e.getCell(this.x,this.y).value}},{key:"findCellsReferenced",value:function(e){return[e.getCell(this.x,this.y)]}}]),t}(N),Object(E.a)(O.prototype,"exec",[v],Object.getOwnPropertyDescriptor(O.prototype,"exec"),O.prototype),O),W=n(31),M=n.n(W),H=(x=function(e){function t(e,n,r){var s;return Object(w.a)(this,t),(s=Object(q.a)(this,Object(_.a)(t).call(this,r))).x=e,s.y=n,s}return Object(A.a)(t,e),Object(S.a)(t,[{key:"exec",value:function(e){var t=this.x.exec(e),n=this.y.exec(e);return e.getCell(t,n).value}},{key:"unParse",value:function(e){var t=this.x.exec(e),n=this.y.exec(e);return e.getCell(t,n).label}}]),t}(N),Object(E.a)(x.prototype,"exec",[v],Object.getOwnPropertyDescriptor(x.prototype,"exec"),x.prototype),x),J=(j=function(e){function t(){return Object(w.a)(this,t),Object(q.a)(this,Object(_.a)(t).apply(this,arguments))}return Object(A.a)(t,e),Object(S.a)(t,[{key:"exec",value:function(e){var t=this.left;if(t instanceof z){var n=e.getReference(t.identifier);void 0!==n&&(t=n)}if(t instanceof z)e.setVariable(t.value,this.right.exec(e));else{if(!(t instanceof V||t instanceof H))throw new b.UserError("Assign not to variable");var r,s;t instanceof V?(r=t.x,s=t.y):(r=t.x.exec(e),s=t.y.exec(e));var a=M.a.cloneDeep(this.right),o={ast:a};!function e(t,n){for(var r in t){if(t[r]instanceof z){var s=n.getReference(t[r].identifier);void 0!==s&&(t[r]=s)}if(t[r]instanceof z){var a=t[r].exec(n);t[r]=new F({value:a,text:a.toString()})}else t[r]instanceof D?e(t[r].args,n):t[r]instanceof N&&e(t[r],n)}}(o,e);var i="="+(a=o.ast).unParse(e);e.setCell(r,s,i)}}}]),t}(R),Object(E.a)(j.prototype,"exec",[v],Object.getOwnPropertyDescriptor(j.prototype,"exec"),j.prototype),j);var Z,G=function(e){function t(e,n,r){var s;return Object(w.a)(this,t),(s=Object(q.a)(this,Object(_.a)(t).call(this,r))).condition=e,s.block=n,s}return Object(A.a)(t,e),Object(S.a)(t,[{key:"exec",value:function(e){for(;this.condition.exec(e);){var t=!0,n=!1,r=void 0;try{for(var s,a=this.block[Symbol.iterator]();!(t=(s=a.next()).done);t=!0){s.value.exec(e)}}catch(o){n=!0,r=o}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}}}}]),t}(N),K=function(e){function t(e,n,r,s){var a;return Object(w.a)(this,t),(a=Object(q.a)(this,Object(_.a)(t).call(this,s))).condition=e,a.block=n,a.elseBlock=r,a}return Object(A.a)(t,e),Object(S.a)(t,[{key:"exec",value:function(e){if(this.condition.exec(e)){var t=!0,n=!1,r=void 0;try{for(var s,a=this.block[Symbol.iterator]();!(t=(s=a.next()).done);t=!0){s.value.exec(e)}}catch(p){n=!0,r=p}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}}else if(null!==this.elseBlock){var o=!0,i=!1,c=void 0;try{for(var l,u=this.elseBlock[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){l.value.exec(e)}}catch(p){i=!0,c=p}finally{try{o||null==u.return||u.return()}finally{if(i)throw c}}}}}]),t}(N),Q=function(e){function t(){return Object(w.a)(this,t),Object(q.a)(this,Object(_.a)(t).apply(this,arguments))}return Object(A.a)(t,e),Object(S.a)(t,[{key:"exec",value:function(e){return this.left.exec(e)===this.right.exec(e)}}]),t}(R),X=function(e){function t(){return Object(w.a)(this,t),Object(q.a)(this,Object(_.a)(t).apply(this,arguments))}return Object(A.a)(t,e),Object(S.a)(t,[{key:"exec",value:function(e){return this.left.exec(e)>=this.right.exec(e)}}]),t}(R),Y=function(e){function t(){return Object(w.a)(this,t),Object(q.a)(this,Object(_.a)(t).apply(this,arguments))}return Object(A.a)(t,e),Object(S.a)(t,[{key:"exec",value:function(e){return this.left.exec(e)<=this.right.exec(e)}}]),t}(R),ee=function(e){function t(){return Object(w.a)(this,t),Object(q.a)(this,Object(_.a)(t).apply(this,arguments))}return Object(A.a)(t,e),Object(S.a)(t,[{key:"exec",value:function(e){return this.left.exec(e)<this.right.exec(e)}}]),t}(R),te=function(e){function t(){return Object(w.a)(this,t),Object(q.a)(this,Object(_.a)(t).apply(this,arguments))}return Object(A.a)(t,e),Object(S.a)(t,[{key:"exec",value:function(e){return this.left.exec(e)>this.right.exec(e)}}]),t}(R),ne=function(e){function t(){return Object(w.a)(this,t),Object(q.a)(this,Object(_.a)(t).apply(this,arguments))}return Object(A.a)(t,e),Object(S.a)(t,[{key:"exec",value:function(e){return this.left.exec(e)!==this.right.exec(e)}}]),t}(R),re=function(e){function t(e,n,r,s){var a;return Object(w.a)(this,t),(a=Object(q.a)(this,Object(_.a)(t).call(this,s))).identifier=e,a.args=n,a.block=r,a}return Object(A.a)(t,e),Object(S.a)(t,[{key:"exec",value:function(e){e.setFunction(this.identifier,this.args,this.block)}}]),t}(N),se=function(e){function t(e,n,r){var s;return Object(w.a)(this,t),(s=Object(q.a)(this,Object(_.a)(t).call(this,r))).identifier=e,s.referenced=n,s}return Object(A.a)(t,e),Object(S.a)(t,[{key:"exec",value:function(e){e.setReference(this.identifier,this.referenced)}}]),t}(N),ae=function(e){function t(e,n){var r;return Object(w.a)(this,t),(r=Object(q.a)(this,Object(_.a)(t).call(this,n))).expr=e,r}return Object(A.a)(t,e),Object(S.a)(t,[{key:"exec",value:function(e){throw new b.returnHandler(this.expr.exec(e))}}]),t}(N),oe=(Z=function(e){function t(e,n,r,s){var a;return Object(w.a)(this,t),(a=Object(q.a)(this,Object(_.a)(t).call(this,s))).variableName=e,a.range=n,a.block=r,a}return Object(A.a)(t,e),Object(S.a)(t,[{key:"exec",value:function(e){var t;if(!((t=this.range instanceof z?e.getReference(this.range.identifier):this.range)instanceof T))throw new b.UserError("Iterating over non iterable");var n=t.getCells(e),r=!0,s=!1,a=void 0;try{for(var o,i=n[Symbol.iterator]();!(r=(o=i.next()).done);r=!0){var c=o.value;e.setReference(this.variableName,new V(c.x,c.y,{}));var l=!0,u=!1,p=void 0;try{for(var f,m=this.block[Symbol.iterator]();!(l=(f=m.next()).done);l=!0){f.value.exec(e)}}catch(h){u=!0,p=h}finally{try{l||null==m.return||m.return()}finally{if(u)throw p}}}}catch(h){s=!0,a=h}finally{try{r||null==i.return||i.return()}finally{if(s)throw a}}}}]),t}(N),Object(E.a)(Z.prototype,"exec",[v],Object.getOwnPropertyDescriptor(Z.prototype,"exec"),Z.prototype),Z);function ie(e){var t=Object(i.a)(e,3),n=t[0],r=t[1],s=t[2];return new I(n,s,r)}function ce(e){var t=Object(i.a)(e,3),n=t[0],r=t[1],s=t[2];return new P(n,s,r)}function le(e){var t=Object(i.a)(e,3),n=t[0],r=t[1],s=t[2];return new U(n,s,r)}function ue(e){var t=Object(i.a)(e,3),n=t[0],r=t[1],s=t[2];return new L(n,s,r)}function pe(e){var t=Object(i.a)(e,1)[0];return new F(t)}function fe(e){var t=Object(i.a)(e,2),n=t[0],r=t[1];return new B(r,n)}function be(e){var t=Object(i.a)(e,3),n=t[0],r=(t[1],t[2]);return new D(n.value,r,n)}function me(e){var t=Object(i.a)(e,3),n=t[0],r=t[1],s=t[2];return new Q(n,s,r)}function he(e){var t=Object(i.a)(e,3),n=t[0],r=t[1],s=t[2];return new X(n,s,r)}function ye(e){var t=Object(i.a)(e,3),n=t[0],r=t[1],s=t[2];return new Y(n,s,r)}function ve(e){var t=Object(i.a)(e,3),n=t[0],r=t[1],s=t[2];return new ee(n,s,r)}function de(e){var t=Object(i.a)(e,3),n=t[0],r=t[1],s=t[2];return new te(n,s,r)}function ge(e){var t=Object(i.a)(e,3),n=t[0],r=t[1],s=t[2];return new ne(n,s,r)}function Oe(e){var t=Object(i.a)(e,1)[0];return new z(t.value,t)}function xe(e){var t=Object(i.a)(e,3),n=t[0],r=t[1],s=t[2];return new T(n,s,r)}function je(e){var t=Object(i.a)(e,3),n=t[0],r=t[1],s=t[2];return new J(n,s,r)}function $e(){return[]}function ke(e){var t=Object(i.a)(e,1)[0];return new V(t.value.x,t.value.y,t)}function we(e){var t=Object(i.a)(e,5),n=(t[0],t[1]),r=(t[2],t[3]),s=t[4];return new H(n,r,s)}function Se(e){var t=Object(i.a)(e,4),n=t[0],r=(t[1],t[2],t[3]);return new se(n.value,r,n)}function Ee(e){var t=Object(i.a)(e,2),n=t[0],r=t[1],s=[n],a=!0,o=!1,c=void 0;try{for(var l,u=r[Symbol.iterator]();!(a=(l=u.next()).done);a=!0){var p=l.value;s.push(p[1])}}catch(f){o=!0,c=f}finally{try{a||null==u.return||u.return()}finally{if(o)throw c}}return s}var Ce=n(22),qe=n(32),_e=n.n(qe),Ae={ws:/[ \t\u00A0\u1680\u2000-\u200a\u2028\u2029\u202f\u3000]+/,end:{match:/\n/,lineBreaks:!0},cell:{match:/[a-zA-Z]+[0-9]+/,value:function(e){return y(e)}},identifier:{match:/[a-zA-Z]+/,type:Ce.keywords({kwIf:"if",kwWhile:"while",kwFor:"for",kwElse:"else",kwDef:"def",kwReturn:"return",kwIn:"in"})},ampersand:"&",dot:".",comma:",",lparen:"(",rparen:")",lsquare:"[",rsquare:"]",plus:"+",asterisk:"*",slash:"/",minus:"-",semicolon:";",colon:":",equal:"==",greaterEqual:">=",lessEqual:"<=",less:"<",greater:">",notEqual:"!=",assign:"=",string:/".*?"/,number:{match:/[1-9][0-9]*(?:\.[0-9]*)?|0(?:\.[0-9]+)?/,value:function(e){return parseFloat(e)}}},Ne=new _e.a(Ce.compile(Ae),"ws","end");function Re(e){return e[0]}var Ie={Lexer:Ne,ParserRules:[{name:"formulaEntry",symbols:["sum"]},{name:"expr",symbols:["comparison"],postprocess:Re},{name:"comparison",symbols:["sum"],postprocess:Re},{name:"comparison",symbols:["sum",Ne.has("equal")?{type:"equal"}:equal,"sum"],postprocess:me},{name:"comparison",symbols:["sum",Ne.has("greaterEqual")?{type:"greaterEqual"}:greaterEqual,"sum"],postprocess:he},{name:"comparison",symbols:["sum",Ne.has("lessEqual")?{type:"lessEqual"}:lessEqual,"sum"],postprocess:ye},{name:"comparison",symbols:["sum",Ne.has("less")?{type:"less"}:less,"sum"],postprocess:ve},{name:"comparison",symbols:["sum",Ne.has("greater")?{type:"greater"}:greater,"sum"],postprocess:de},{name:"comparison",symbols:["sum",Ne.has("notEqual")?{type:"notEqual"}:notEqual,"sum"],postprocess:ge},{name:"sum",symbols:["product"],postprocess:Re},{name:"sum",symbols:["sum",Ne.has("plus")?{type:"plus"}:plus,"product"],postprocess:ie},{name:"sum",symbols:["sum",Ne.has("minus")?{type:"minus"}:minus,"product"],postprocess:ce},{name:"product",symbols:["primary"],postprocess:Re},{name:"product",symbols:["product",Ne.has("asterisk")?{type:"asterisk"}:asterisk,"primary"],postprocess:le},{name:"product",symbols:["product",Ne.has("slash")?{type:"slash"}:slash,"primary"],postprocess:ue},{name:"primary",symbols:[Ne.has("lparen")?{type:"lparen"}:lparen,"expr",Ne.has("rparen")?{type:"rparen"}:rparen],postprocess:function(e){return e[1]}},{name:"primary",symbols:[Ne.has("number")?{type:"number"}:number],postprocess:pe},{name:"primary",symbols:["variable"],postprocess:Re},{name:"primary",symbols:["function_call"],postprocess:Re},{name:"primary",symbols:["range"],postprocess:Re},{name:"primary",symbols:["cell"],postprocess:Re},{name:"primary",symbols:[Ne.has("minus")?{type:"minus"}:minus,"primary"],postprocess:fe},{name:"primary",symbols:["dynamicCell"],postprocess:Re},{name:"dynamicCell",symbols:[Ne.has("lsquare")?{type:"lsquare"}:lsquare,"sum",Ne.has("semicolon")?{type:"semicolon"}:semicolon,"sum",Ne.has("rsquare")?{type:"rsquare"}:rsquare],postprocess:we},{name:"cell",symbols:[Ne.has("cell")?{type:"cell"}:cell],postprocess:ke},{name:"variable",symbols:[Ne.has("identifier")?{type:"identifier"}:identifier],postprocess:Oe},{name:"function_call",symbols:[Ne.has("identifier")?{type:"identifier"}:identifier,Ne.has("lparen")?{type:"lparen"}:lparen,"args",Ne.has("rparen")?{type:"rparen"}:rparen],postprocess:be},{name:"function_call",symbols:[Ne.has("kwIf")?{type:"kwIf"}:kwIf,Ne.has("lparen")?{type:"lparen"}:lparen,"args",Ne.has("rparen")?{type:"rparen"}:rparen],postprocess:be},{name:"args$ebnf$1",symbols:[]},{name:"args$ebnf$1$subexpression$1",symbols:[Ne.has("comma")?{type:"comma"}:comma,"expr"]},{name:"args$ebnf$1",symbols:["args$ebnf$1","args$ebnf$1$subexpression$1"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"args",symbols:["expr","args$ebnf$1"],postprocess:Ee},{name:"args",symbols:[],postprocess:$e},{name:"range",symbols:["cell",Ne.has("colon")?{type:"colon"}:colon,"cell"],postprocess:xe},{name:"entry$ebnf$1",symbols:[]},{name:"entry$ebnf$1$subexpression$1",symbols:[Ne.has("end")?{type:"end"}:end]},{name:"entry$ebnf$1",symbols:["entry$ebnf$1","entry$ebnf$1$subexpression$1"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"entry$ebnf$2",symbols:[]},{name:"entry$ebnf$2$subexpression$1",symbols:[Ne.has("end")?{type:"end"}:end]},{name:"entry$ebnf$2",symbols:["entry$ebnf$2","entry$ebnf$2$subexpression$1"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"entry",symbols:["entry$ebnf$1","code","entry$ebnf$2"],postprocess:function(e){return[e[1]]}},{name:"code$ebnf$1",symbols:[]},{name:"code$ebnf$1$subexpression$1",symbols:["statement"]},{name:"code$ebnf$1",symbols:["code$ebnf$1","code$ebnf$1$subexpression$1"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"code",symbols:["statement","code$ebnf$1"],postprocess:function(e){var t=Object(i.a)(e,2),n=t[0],r=t[1],s=[n],a=!0,o=!1,c=void 0;try{for(var l,u=r[Symbol.iterator]();!(a=(l=u.next()).done);a=!0){var p=l.value;s.push(p[0])}}catch(f){o=!0,c=f}finally{try{a||null==u.return||u.return()}finally{if(o)throw c}}return s}},{name:"statement",symbols:["expr","ends"],postprocess:Re},{name:"statement",symbols:["reference","ends"],postprocess:Re},{name:"statement",symbols:["return","ends"],postprocess:Re},{name:"statement",symbols:["assigment","ends"],postprocess:Re},{name:"statement$ebnf$1",symbols:[]},{name:"statement$ebnf$1$subexpression$1",symbols:[Ne.has("end")?{type:"end"}:end]},{name:"statement$ebnf$1",symbols:["statement$ebnf$1","statement$ebnf$1$subexpression$1"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"statement",symbols:["blockStatement","statement$ebnf$1"],postprocess:Re},{name:"blockStatement$ebnf$1$subexpression$1",symbols:[Ne.has("end")?{type:"end"}:end]},{name:"blockStatement$ebnf$1",symbols:["blockStatement$ebnf$1$subexpression$1"],postprocess:Re},{name:"blockStatement$ebnf$1",symbols:[],postprocess:function(e){return null}},{name:"blockStatement",symbols:[Ne.has("kwWhile")?{type:"kwWhile"}:kwWhile,"expr","blockStatement$ebnf$1","block"],postprocess:function(e){var t=Object(i.a)(e,4),n=t[0],r=t[1],s=t[3];return new G(r,s,n)}},{name:"blockStatement$ebnf$2$subexpression$1",symbols:[Ne.has("end")?{type:"end"}:end]},{name:"blockStatement$ebnf$2",symbols:["blockStatement$ebnf$2$subexpression$1"],postprocess:Re},{name:"blockStatement$ebnf$2",symbols:[],postprocess:function(e){return null}},{name:"blockStatement$ebnf$3$subexpression$1",symbols:["else"]},{name:"blockStatement$ebnf$3",symbols:["blockStatement$ebnf$3$subexpression$1"],postprocess:Re},{name:"blockStatement$ebnf$3",symbols:[],postprocess:function(e){return null}},{name:"blockStatement",symbols:[Ne.has("kwIf")?{type:"kwIf"}:kwIf,"expr","blockStatement$ebnf$2","block","blockStatement$ebnf$3"],postprocess:function(e){var t=Object(i.a)(e,5),n=t[0],r=t[1],s=t[3],a=t[4];return null!==a&&(a=a[0]),new K(r,s,a,n)}},{name:"blockStatement$ebnf$4$subexpression$1",symbols:[Ne.has("end")?{type:"end"}:end]},{name:"blockStatement$ebnf$4",symbols:["blockStatement$ebnf$4$subexpression$1"],postprocess:Re},{name:"blockStatement$ebnf$4",symbols:[],postprocess:function(e){return null}},{name:"blockStatement",symbols:[Ne.has("kwDef")?{type:"kwDef"}:kwDef,Ne.has("identifier")?{type:"identifier"}:identifier,Ne.has("lparen")?{type:"lparen"}:lparen,"params",Ne.has("rparen")?{type:"rparen"}:rparen,"blockStatement$ebnf$4","block"],postprocess:function(e){var t=Object(i.a)(e,7),n=(t[0],t[1]),r=(t[2],t[3]),s=(t[4],t[5],t[6]);return new re(n.value,r,s,n)}},{name:"blockStatement$ebnf$5$subexpression$1",symbols:[Ne.has("end")?{type:"end"}:end]},{name:"blockStatement$ebnf$5",symbols:["blockStatement$ebnf$5$subexpression$1"],postprocess:Re},{name:"blockStatement$ebnf$5",symbols:[],postprocess:function(e){return null}},{name:"blockStatement",symbols:[Ne.has("kwFor")?{type:"kwFor"}:kwFor,Ne.has("identifier")?{type:"identifier"}:identifier,Ne.has("kwIn")?{type:"kwIn"}:kwIn,"expr","blockStatement$ebnf$5","block"],postprocess:function(e){var t=Object(i.a)(e,6),n=(t[0],t[1]),r=(t[2],t[3]),s=(t[4],t[5]);return new oe(n.value,r,s,n)}},{name:"else",symbols:[Ne.has("kwElse")?{type:"kwElse"}:kwElse,"ends","block"],postprocess:function(e){return Object(i.a)(e,3)[2]}},{name:"assigment",symbols:["variable",Ne.has("assign")?{type:"assign"}:assign,"expr"],postprocess:je},{name:"assigment",symbols:["cell",Ne.has("assign")?{type:"assign"}:assign,"expr"],postprocess:je},{name:"assigment",symbols:["dynamicCell",Ne.has("assign")?{type:"assign"}:assign,"expr"],postprocess:je},{name:"block",symbols:[Ne.has("indent")?{type:"indent"}:indent,"code",Ne.has("dedent")?{type:"dedent"}:dedent],postprocess:function(e){return Object(i.a)(e,2)[1]}},{name:"ends$ebnf$1$subexpression$1",symbols:[Ne.has("end")?{type:"end"}:end]},{name:"ends$ebnf$1",symbols:["ends$ebnf$1$subexpression$1"]},{name:"ends$ebnf$1$subexpression$2",symbols:[Ne.has("end")?{type:"end"}:end]},{name:"ends$ebnf$1",symbols:["ends$ebnf$1","ends$ebnf$1$subexpression$2"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"ends",symbols:["ends$ebnf$1"],postprocess:null},{name:"reference",symbols:[Ne.has("identifier")?{type:"identifier"}:identifier,Ne.has("assign")?{type:"assign"}:assign,Ne.has("ampersand")?{type:"ampersand"}:ampersand,"range"],postprocess:Se},{name:"reference",symbols:[Ne.has("identifier")?{type:"identifier"}:identifier,Ne.has("assign")?{type:"assign"}:assign,Ne.has("ampersand")?{type:"ampersand"}:ampersand,"cell"],postprocess:Se},{name:"reference",symbols:[Ne.has("identifier")?{type:"identifier"}:identifier,Ne.has("assign")?{type:"assign"}:assign,Ne.has("ampersand")?{type:"ampersand"}:ampersand,"variable"],postprocess:Se},{name:"return",symbols:[Ne.has("kwReturn")?{type:"kwReturn"}:kwReturn,"expr"],postprocess:function(e){var t=Object(i.a)(e,2),n=t[0],r=t[1];return new ae(r,n)}},{name:"params$ebnf$1",symbols:[]},{name:"params$ebnf$1$subexpression$1",symbols:[Ne.has("comma")?{type:"comma"}:comma,"variable"]},{name:"params$ebnf$1",symbols:["params$ebnf$1","params$ebnf$1$subexpression$1"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"params",symbols:["variable","params$ebnf$1"],postprocess:Ee},{name:"params",symbols:[],postprocess:$e}],ParserStart:"entry"};function Pe(e){return e[0]}var Ue,Le,Fe,Be,Te,De,ze,Ve={Lexer:Ne,ParserRules:[{name:"formulaEntry",symbols:["sum"]},{name:"expr",symbols:["comparison"],postprocess:Pe},{name:"comparison",symbols:["sum"],postprocess:Pe},{name:"comparison",symbols:["sum",Ne.has("equal")?{type:"equal"}:equal,"sum"],postprocess:me},{name:"comparison",symbols:["sum",Ne.has("greaterEqual")?{type:"greaterEqual"}:greaterEqual,"sum"],postprocess:he},{name:"comparison",symbols:["sum",Ne.has("lessEqual")?{type:"lessEqual"}:lessEqual,"sum"],postprocess:ye},{name:"comparison",symbols:["sum",Ne.has("less")?{type:"less"}:less,"sum"],postprocess:ve},{name:"comparison",symbols:["sum",Ne.has("greater")?{type:"greater"}:greater,"sum"],postprocess:de},{name:"comparison",symbols:["sum",Ne.has("notEqual")?{type:"notEqual"}:notEqual,"sum"],postprocess:ge},{name:"sum",symbols:["product"],postprocess:Pe},{name:"sum",symbols:["sum",Ne.has("plus")?{type:"plus"}:plus,"product"],postprocess:ie},{name:"sum",symbols:["sum",Ne.has("minus")?{type:"minus"}:minus,"product"],postprocess:ce},{name:"product",symbols:["primary"],postprocess:Pe},{name:"product",symbols:["product",Ne.has("asterisk")?{type:"asterisk"}:asterisk,"primary"],postprocess:le},{name:"product",symbols:["product",Ne.has("slash")?{type:"slash"}:slash,"primary"],postprocess:ue},{name:"primary",symbols:[Ne.has("lparen")?{type:"lparen"}:lparen,"expr",Ne.has("rparen")?{type:"rparen"}:rparen],postprocess:function(e){return e[1]}},{name:"primary",symbols:[Ne.has("number")?{type:"number"}:number],postprocess:pe},{name:"primary",symbols:["variable"],postprocess:Pe},{name:"primary",symbols:["function_call"],postprocess:Pe},{name:"primary",symbols:["range"],postprocess:Pe},{name:"primary",symbols:["cell"],postprocess:Pe},{name:"primary",symbols:[Ne.has("minus")?{type:"minus"}:minus,"primary"],postprocess:fe},{name:"primary",symbols:["dynamicCell"],postprocess:Pe},{name:"dynamicCell",symbols:[Ne.has("lsquare")?{type:"lsquare"}:lsquare,"sum",Ne.has("semicolon")?{type:"semicolon"}:semicolon,"sum",Ne.has("rsquare")?{type:"rsquare"}:rsquare],postprocess:we},{name:"cell",symbols:[Ne.has("cell")?{type:"cell"}:cell],postprocess:ke},{name:"variable",symbols:[Ne.has("identifier")?{type:"identifier"}:identifier],postprocess:Oe},{name:"function_call",symbols:[Ne.has("identifier")?{type:"identifier"}:identifier,Ne.has("lparen")?{type:"lparen"}:lparen,"args",Ne.has("rparen")?{type:"rparen"}:rparen],postprocess:be},{name:"function_call",symbols:[Ne.has("kwIf")?{type:"kwIf"}:kwIf,Ne.has("lparen")?{type:"lparen"}:lparen,"args",Ne.has("rparen")?{type:"rparen"}:rparen],postprocess:be},{name:"args$ebnf$1",symbols:[]},{name:"args$ebnf$1$subexpression$1",symbols:[Ne.has("comma")?{type:"comma"}:comma,"expr"]},{name:"args$ebnf$1",symbols:["args$ebnf$1","args$ebnf$1$subexpression$1"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"args",symbols:["expr","args$ebnf$1"],postprocess:Ee},{name:"args",symbols:[],postprocess:$e},{name:"range",symbols:["cell",Ne.has("colon")?{type:"colon"}:colon,"cell"],postprocess:xe}],ParserStart:"formulaEntry"},We=function(){function e(){Object(w.a)(this,e),this.parser=new C.Parser(C.Grammar.fromCompiled(Ie))}return Object(S.a)(e,[{key:"feed",value:function(e){try{this.parser.feed(e)}catch(t){throw new b.UserError(t.message)}}},{key:"results",get:function(){try{return this.parser.results[0][0]}catch(e){return null}}}]),e}(),Me=function(){function e(){Object(w.a)(this,e),this.parser=new C.Parser(C.Grammar.fromCompiled(Ve))}return Object(S.a)(e,[{key:"feed",value:function(e){try{this.parser.feed(e)}catch(t){throw new b.UserError("Syntax error")}}},{key:"results",get:function(){try{return this.parser.results[0][0]}catch(e){return null}}}]),e}(),He=function e(t){Object(w.a)(this,e),this.value=null,this.value=t},Je=n(7),Ze=(Ue=function(){function e(t,n,r){Object(w.a)(this,e),Object(k.a)(this,"formula",Le,this),Object(k.a)(this,"value",Fe,this),Object(k.a)(this,"background",Be,this),Object(k.a)(this,"error",Te,this),this.ast=null,this.observers=[],this.subjects=[],this.x=t,this.y=n,this.label=r}return Object(S.a)(e,[{key:"reset",value:function(){this.formula=null,this.value=null,this.background=null,this.error=null,this.ast=null,this.observers=[],this.subjects=[]}},{key:"unregisterFromAllSubjects",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,s=this.subjects[Symbol.iterator]();!(e=(r=s.next()).done);e=!0){r.value._unregisterObserver(this)}}catch(a){t=!0,n=a}finally{try{e||null==s.return||s.return()}finally{if(t)throw n}}this.subjects=[]}},{key:"observe",value:function(e){e.observers.push(this),this.subjects.push(e)}},{key:"_unregisterObserver",value:function(e){var t=this.observers.indexOf(e);t===this.observers.length-1?this.observers.pop():this.observers[t]=this.observers.pop()}}]),e}(),Le=Object(E.a)(Ue.prototype,"formula",[Je.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Fe=Object(E.a)(Ue.prototype,"value",[Je.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Be=Object(E.a)(Ue.prototype,"background",[Je.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Te=Object(E.a)(Ue.prototype,"error",[Je.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ue),Ge=function(){function e(t,n){Object(w.a)(this,e),this.funcitons={},this.x=t,this.y=n,this.cells=Array(n);for(var r=0;r<n;r++){this.cells[r]=Array(t);for(var s=h(),a=0;a<t;a++){var o=s.next().value+(r+1).toString();this.cells[r][a]=new Ze(a,r,o)}}this.variablesScopes=[{}],this.referencesScopes=[{}]}return Object(S.a)(e,[{key:"reset",value:function(){for(var e=0;e<this.y;e++)for(var t=0;t<this.x;t++)this.cells[e][t].reset()}},{key:"setCell",value:function(e,t,n){var r=this.getCell(e,t);r.unregisterFromAllSubjects();try{if(function(e){return"="===e.charAt(0)}(n)){if(1===n.length)return;this._setCellFormula(r,n)}else this._setCellValue(r,n);this._updateObservers(r),r.error=null}catch(s){if("UserError"!==s.name)throw s;r.error=s.message.split("\n")[1]}}},{key:"_setCellFormula",value:function(e,t){e.formula=t;var n=new Me;n.feed(t.substring(1)),e.ast=n.results,e.value=e.ast.exec(this);var r=e.ast.findCellsReferenced(this),s=!0,a=!1,o=void 0;try{for(var i,c=r[Symbol.iterator]();!(s=(i=c.next()).done);s=!0){var l=i.value;e.observe(l)}}catch(u){a=!0,o=u}finally{try{s||null==c.return||c.return()}finally{if(a)throw o}}}},{key:"_setCellValue",value:function(e,t){var n=parseFloat(t);isNaN(n)?e.value=t:e.value=n,e.formula=null,e.ast=null}},{key:"getCellsByRange",value:function(e,t){var n=e.x,r=e.y,s=t.x,a=t.y;if(this.x<=n||this.y<=r)throw new b.UserError("No cell: ".concat(e));if(this.x<=s||this.y<=a)throw new b.UserError("No cell: ".concat(t));for(var o=[],i=r;i<=a;i++)for(var c=n;c<=s;c++)o.push(this.cells[i][c]);return o}},{key:"getCell",value:function(e,t){var n;try{n=this.cells[t][e]}catch(r){}if(void 0===n)throw new b.UserError("No such cell");return n}},{key:"_updateObservers",value:function(e){var t=!0,n=!1,r=void 0;try{for(var s,a=function(e){var t=[],n=[];return function e(r){if(n.includes(r))return;if(t.includes(r))throw new b.UserError("Cycle");t.push(r);var s=!0,a=!1,o=void 0;try{for(var i,c=r.observers[Symbol.iterator]();!(s=(i=c.next()).done);s=!0){var l=i.value;e(l)}}catch(u){a=!0,o=u}finally{try{s||null==c.return||c.return()}finally{if(a)throw o}}n.push(r)}(e),n.reverse().slice(1)}(e)[Symbol.iterator]();!(t=(s=a.next()).done);t=!0){var o=s.value;o.value=o.ast.exec(this)}}catch(i){n=!0,r=i}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}}},{key:"setVariable",value:function(e,t){var n=this.variablesScopes[this.variablesScopes.length-1];try{this.getVarByName(e).value=t}catch(r){n[e]=new He(t)}}},{key:"getVarByName",value:function(e){var t=this.variablesScopes[this.variablesScopes.length-1];if(t.hasOwnProperty(e))return t[e];throw new b.UserError("No variable: ".concat(e))}},{key:"setReference",value:function(e,t){if(!e instanceof String)throw console.log(e),Error("setReference called with wrong type");this.referencesScopes[this.referencesScopes.length-1][e]=t}},{key:"getReference",value:function(e){if(!e instanceof String)throw Error("getReference called with wrong type");var t=this.referencesScopes[this.referencesScopes.length-1][e];return t instanceof se&&(t=this.getReference(t.identifier)),t}},{key:"setFunction",value:function(e,t,n){this.funcitons[e]={args:t,block:n}}},{key:"getFunction",value:function(e){if(!e instanceof String||!this.funcitons.hasOwnProperty(e))throw new b.UserError("No function: ".concat(e));return this.funcitons[e]}},{key:"newScope",value:function(){this.variablesScopes.push({}),this.referencesScopes.push({})}},{key:"popScope",value:function(){this.variablesScopes.pop(),this.referencesScopes.pop()}}]),e}(),Ke=(De=function(){function e(t,n){Object(w.a)(this,e),Object(k.a)(this,"annotations",ze,this),this.env=new Ge(t,n)}return Object(S.a)(e,[{key:"reset",value:function(){this.env.reset()}},{key:"onCellSet",value:function(e,t,n){this.env.setCell(e,t,n)}},{key:"cellsToObjects",value:function(){for(var e={},t=0;t<this.env.y;t++)for(var n=0;n<this.env.x;n++){var r=this.env.getCell(n,t),s=void 0;if(r.formula)s=r.formula;else{if(!r.value)continue;s=r.value}e[r.label]=s}return e}},{key:"run",value:function(e){if(this.annotations=[],""!==e)try{var t=new We;if(t.feed(e),t.results){var n=!0,r=!1,s=void 0;try{for(var a,o=t.results[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){a.value.exec(this.env)}}catch(m){r=!0,s=m}finally{try{n||null==o.return||o.return()}finally{if(r)throw s}}}}catch(h){if("UserError"!==h.name)throw h;var i=/.*line (\d*).*col (\d*)/gm.exec(h.message);if(null!==i){var c=parseInt(i[1])-1,l=parseInt(i[2]),u=h.message.split("\n"),p=Math.min(5,u.length),f="";4 in u&&(u[4]=u[4].substring(0,u[4].indexOf("Instead")));for(var b=0;b<p;b++)f+=u[b]+"\n";this.annotations=[{row:c,column:l,type:"error",text:f}]}else this.annotations=[{row:0,column:0,type:"error",text:h.message}];console.log(h.message)}}},{key:"logParseTree",value:function(e){this.annotations=[];try{var t=new We;t.feed(e),console.log(t.results)}catch(n){if("UserError"!==n.name)throw n;console.log(n.message)}}},{key:"logLexerOutput",value:function(e){this.annotations=[];try{Ne.reset(e);for(var t=[],n=Ne.next();void 0!==n;)t.push(n),n=Ne.next();console.log(t)}catch(r){if("UserError"!==r.name)throw r;console.log(r.message)}}}]),e}(),ze=Object(E.a)(De.prototype,"annotations",[Je.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),De),Qe=n(33),Xe=n.n(Qe),Ye=n(20),et=n.n(Ye),tt=n(34),nt=n.n(tt),rt=(n(52),n(53),n(54),Object(c.a)((function(e){var t=Object(r.useState)(""),n=Object(i.a)(t,2),a=n[0],o=n[1],c=function(e){"\n"!==e[e.length-1]&&(e+="\n"),o(e)};return s.a.createElement("div",{className:et.a.Editor},s.a.createElement("div",{className:et.a.Top},s.a.createElement("label",{className:et.a.customFileUpload},"Open",s.a.createElement("input",{type:"file",onChange:function(t){var n=t.target.files[0],r=new FileReader;r.addEventListener("load",(function(t){var n=t.target.result,r=JSON.parse(n),s=r.code,a=r.cells;c(s),e.onSubmit(s),e.onLoad(a)})),r.readAsText(n)}})," "),s.a.createElement("button",{onClick:function(){return e.onSave(a)}},"Save")),s.a.createElement(nt.a,{mode:"python",theme:"cobalt",onChange:c,value:a,height:"100%",width:"100%",annotations:at.annotations}),s.a.createElement("div",{className:et.a.Bottom},s.a.createElement("button",{onClick:function(){return e.onLogParseTree(a)}},"Log parse tree"),s.a.createElement("button",{onClick:function(){return e.onLogLexerOutput(a)}},"Log tokens"),s.a.createElement("button",{onClick:function(){return e.onSubmit(a)}},"Run")))}))),st=n(35),at=new Ke(5,30);var ot=Object(c.a)((function(){return s.a.createElement("div",{className:Xe.a.App},s.a.createElement($,{x:at.env.x,y:at.env.y,cells:at.env.cells,onCellSet:function(e,t,n){return at.onCellSet(e,t,n)}}),s.a.createElement(rt,{onLoad:function(e){return function(e){for(var t in at.reset(),e)if(e.hasOwnProperty(t))try{var n=y(t),r=n.x,s=n.y;at.onCellSet(r,s,e[t])}catch(a){}}(e)},onSave:function(e){return function(e,t){var n={cells:t.cellsToObjects(),code:e},r=new Blob([JSON.stringify(n,null,1)],{type:"text/plain;charset=utf-8"});Object(st.saveAs)(r,"spreadsheet.txt")}(e,at)},onSubmit:function(e){return at.run(e)},onLogLexerOutput:function(e){return at.logLexerOutput(e)},onLogParseTree:function(e){return at.logParseTree(e)}}))}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(s.a.createElement(ot,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},9:function(e,t,n){"use strict";n.r(t),n.d(t,"returnMessage",(function(){return l})),n.d(t,"UserError",(function(){return u})),n.d(t,"returnHandler",(function(){return p}));var r=n(1),s=n(5),a=n(3),o=n(18),i=n(4),c=n(23),l="Return in unexpected place",u=function(e){function t(){var e,n;Object(r.a)(this,t);for(var i=arguments.length,c=new Array(i),l=0;l<i;l++)c[l]=arguments[l];return(n=Object(s.a)(this,(e=Object(a.a)(t)).call.apply(e,[this].concat(c)))).name="UserError",Error.captureStackTrace&&Error.captureStackTrace(Object(o.a)(n),t),n}return Object(i.a)(t,e),t}(Object(c.a)(Error)),p=function(e){function t(e){var n,i;Object(r.a)(this,t);for(var c=arguments.length,l=new Array(c>1?c-1:0),p=1;p<c;p++)l[p-1]=arguments[p];return(i=Object(s.a)(this,(n=Object(a.a)(t)).call.apply(n,[this].concat(l)))).result=e,i.name="returnHandler",Error.captureStackTrace&&Error.captureStackTrace(Object(o.a)(i),u),i}return Object(i.a)(t,e),t}(Object(c.a)(Error))}},[[37,1,2]]]);
//# sourceMappingURL=main.8ebef5af.chunk.js.map