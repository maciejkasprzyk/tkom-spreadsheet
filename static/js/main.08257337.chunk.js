(this["webpackJsonptkom-spreadsheet"]=this["webpackJsonptkom-spreadsheet"]||[]).push([[0],{11:function(e,t,r){"use strict";r.d(t,"b",(function(){return c})),r.d(t,"c",(function(){return i})),r.d(t,"a",(function(){return l}));var n=r(21),s=r.n(n),a=r(8),o=s.a.mark(c);function c(){var e,t,r;return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e=function(e){return String.fromCharCode(e.charCodeAt(0)+1)},t=["A"];case 2:return n.next=5,t.slice().reverse().join("");case 5:t[r=0]=e(t[r]);case 7:if(!(t[r].charCodeAt(0)>"Z".charCodeAt(0))){n.next=16;break}if(t[r]="A",!(++r>=t.length)){n.next=13;break}return t.push("A"),n.abrupt("break",16);case 13:t[r]=e(t[r]),n.next=7;break;case 16:n.next=2;break;case 18:case"end":return n.stop()}}),o)}function i(e){var t=[],r=[];return function e(n){if(r.includes(n))return;if(t.includes(n))throw new a.UserError("Cycle");t.push(n);var s=!0,o=!1,c=void 0;try{for(var i,l=n.observers[Symbol.iterator]();!(s=(i=l.next()).done);s=!0){var u=i.value;e(u)}}catch(p){o=!0,c=p}finally{try{s||null==l.return||l.return()}finally{if(o)throw c}}r.push(n)}(e),r.reverse().slice(1)}function l(e){return"="===e.charAt(0)}},13:function(e,t,r){e.exports={Spreadsheet:"Spreadsheet_Spreadsheet__2MlAU",focus:"Spreadsheet_focus__2PRei",error:"Spreadsheet_error__2OBGk"}},19:function(e,t,r){e.exports={Editor:"Editor_Editor__3K0No",Top:"Editor_Top__3e9Hb",Bottom:"Editor_Bottom__MdgSJ"}},29:function(module,__webpack_exports__,__webpack_require__){"use strict";var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_Spreadsheet__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(30),_mobx_SpreadsheetStore__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(36),_App_module_scss__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(33),_App_module_scss__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_App_module_scss__WEBPACK_IMPORTED_MODULE_3__),_Editor__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(34),store=new _mobx_SpreadsheetStore__WEBPACK_IMPORTED_MODULE_2__.a(5,100);function App(){return Object(react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(populateSheet,[]),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{className:_App_module_scss__WEBPACK_IMPORTED_MODULE_3___default.a.App},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_Spreadsheet__WEBPACK_IMPORTED_MODULE_1__.a,{x:store.env.x,y:store.env.y,cells:store.env.cells,onCellSet:function(e,t,r){return store.onCellSet(e,t,r)}}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_Editor__WEBPACK_IMPORTED_MODULE_4__.a,{examples:examples,onSubmit:function(e){return store.run(e)},onLogLexerOutput:function(e){return store.logLexerOutput(e)},onLogParseTree:function(e){return store.logParseTree(e)}}))}__webpack_exports__.a=App;var examples=["i = 0\nwhile i < 5\n    cell[15][i] = i\n    i = i + 1","A1 = 1\ni = 5\nwhile i > 0\n    i = i - 1\n    a = A1\n    A1 = a + 1","if A1 == 5\n    A2 = 5\nelse\n    A2 = 10  \n",'A1.background = "#52A"',"x = 5\nA2 = 3\nA1 = x + 10 + A2\n"];function populateSheet(){var r=0;store.onCellSet(0,r,"Self reference"),store.onCellSet(0,r,"Self reference"),store.onCellSet(1,r,"=B1"),store.onCellSet(0,++r,"Cycle"),store.onCellSet(1,r,"=C2"),store.onCellSet(2,r,"=B2"),store.onCellSet(0,++r,"Auto update working"),store.onCellSet(2,r,"=B3"),store.onCellSet(3,r,"=B3+C3"),store.onCellSet(1,r,"co\u015b"),store.onCellSet(0,++r,"Simple math");var x="1+2*(5+5)+2/3+((1*3))/2";store.onCellSet(1,r,"="+x),store.onCellSet(2,r,"is ".concat(eval(x))),store.onCellSet(0,++r,"Complex math"),x="1-1+2*(5+5)+2/3+((1*3))/2",store.onCellSet(1,r,"="+x),store.onCellSet(2,r,"is ".concat(eval(x))),store.onCellSet(0,++r,"Negative numbers"),x="1-1+1",store.onCellSet(1,r,"="+x),store.onCellSet(2,r,"is ".concat(eval(x))),store.onCellSet(0,++r,"Math with labels"),store.onCellSet(1,r,"=C7+D7*E7"),store.onCellSet(2,r,"2"),store.onCellSet(3,r,"2"),store.onCellSet(4,r,"2"),store.onCellSet(0,++r,"Invalid formulas"),store.onCellSet(1,r,"=C7D7*E7"),store.onCellSet(2,r,"=as325"),store.onCellSet(3,r,"=1**2"),store.onCellSet(0,++r,"* and / order"),x="3/3*3",store.onCellSet(1,r,"="+x),store.onCellSet(2,r,"is ".concat(eval(x))),store.onCellSet(0,++r,"- at the begging and --"),x="-1+2",store.onCellSet(1,r,"="+x),store.onCellSet(2,r,"is ".concat(eval(x))),store.onCellSet(0,++r,"function call"),store.onCellSet(1,r,"=sum(C11;D11;E11)"),store.onCellSet(2,r,"1"),store.onCellSet(3,r,"2"),store.onCellSet(4,r,"3"),store.onCellSet(0,++r,"function with range"),store.onCellSet(1,r,"=sum(C11:E12)"),store.onCellSet(2,r,"1"),store.onCellSet(3,r,"2"),store.onCellSet(4,r,"3"),store.onCellSet(0,++r,"Not existing function"),store.onCellSet(1,r,"=foo(C11:E12)"),store.onCellSet(0,++r,"If"),store.onCellSet(1,r,"=if(C14<D14;1;0)"),store.onCellSet(2,r,"5"),store.onCellSet(3,r,"6")}},30:function(e,t,r){"use strict";var n=r(7),s=r(0),a=r.n(s),o=r(38),c=r(13),i=r.n(c),l=r(11);t.a=Object(o.a)((function(e){var t=function(e){var t=Object(s.useState)(e),r=Object(n.a)(t,2),a=r[0],o=r[1];return[function(e){return a&&a.x===e.x&&a.y===e.y},function(e){o(null==e?null:{x:e.x,y:e.y})}]}(),r=Object(n.a)(t,2),o=r[0],c=r[1],u=function(e){13===e.keyCode&&e.target.blur()},p=Object(l.b)();return a.a.createElement("div",{className:i.a.Spreadsheet},a.a.createElement("table",null,a.a.createElement("thead",null,a.a.createElement("tr",null,a.a.createElement("th",null),Array(e.x).fill(0).map((function(e,t){return a.a.createElement("th",{key:t},p.next().value)})))),a.a.createElement("tbody",null,e.cells.map((function(t,r){return a.a.createElement("tr",{key:r},a.a.createElement("th",null,r+1),t.map((function(t,r){return a.a.createElement("td",{style:{backgroundColor:t.background},onClick:function(e){return function(e,t){c(t)}(0,t)},key:r},o(t)?a.a.createElement("input",{onKeyDown:u,onFocus:function(e){return function(e,t){e.target.value=t.formula?t.formula:t.value,e.target.parentNode.classList.add(i.a.focus)}(e,t)},onBlur:function(r){return function(t,r){e.onCellSet(r.x,r.y,t.target.value),t.target.parentNode.classList.remove(i.a.focus),o(r)&&c(null)}(r,t)},autoFocus:!0}):a.a.createElement("div",{className:t.error?i.a.error:""},t.error?t.error:t.value))})))})))))}))},32:function(e,t,r){!function(){function t(e,t,r){this.lexer=e,this.ws=t,this.end=r}function n(e,t){return 0===e.lastIndexOf(t,0)}function s(e){for(var t="",r=0;r<e.length;++r){for(var n=e.charCodeAt(r),s="",a=0;a<4;++a){var o=n%16;n/=16;var c=o<10?48:87;s=String.fromCharCode(o+c)+s}t+="\\u"+s}return'"'+t+'"'}t.prototype.next=function(){try{return this.ignoreWhiteSpaceNext()}catch(e){throw new(r(8).UserError)(e.message)}},t.prototype.ignoreWhiteSpaceNext=function(){for(var e;(e=this.indentedNext())&&e.type===this.ws;);return e},t.prototype.indentedNext=function(){for(;0===this.tokens.length;)this.generateMoreTokens();return this.tokens.shift()},t.prototype.generateMoreTokens=function(){var e=this.lexer.next(this);if(!e)return this.changeIndent(""),void this.tokens.push(e);this.afterNewLine?(this.afterNewLine=!1,e.type===this.ws?this.changeIndent(e.value,e.col,e.line,e.offset):(this.changeIndent("",e.col,e.line,e.offset),this.tokens.push(e))):this.tokens.push(e),this.afterNewLine=e.type===this.end},t.prototype.changeIndent=function(e,t,r,a){for(;e!==this.indents[this.indents.length-1];){var o=this.indents[this.indents.length-1];if(n(e,o))return this.tokens.push({type:"indent",text:e,value:e,lineBreaks:0,col:t,line:r,offset:a}),void this.indents.push(e);if(!n(o,e))throw o=s(o),e=s(e),Error("Indentations cannot be compared: "+o+" and "+e+".");this.tokens.push({type:"dedent",text:e,value:e,lineBreaks:0,col:t,line:r,offset:a}),this.indents.pop()}},t.prototype.save=function(){return this.lexer.save()},t.prototype.reset=function(e,t){this.lexer.reset(e,t),this.indents=[""],this.tokens=[],this.afterNewLine=!0},t.prototype.formatError=function(e){return this.lexer.formatError(e,"Invalid syntax")},t.prototype.has=function(e){return this.lexer.has(e)},e.exports?e.exports=t:window.IndentedLexer=t}()},33:function(e,t,r){e.exports={App:"App_App__rq8wc"}},34:function(e,t,r){"use strict";var n=r(7),s=r(0),a=r.n(s),o=r(19),c=r.n(o),i=r(35),l=r.n(i),u=(r(55),r(56),r(57),function(e){var t=Object(s.useState)(""),r=Object(n.a)(t,2),o=r[0],i=r[1],u=function(e){"\n"!==e[e.length-1]&&(e+="\n"),i(e)};return a.a.createElement("div",{className:c.a.Editor},a.a.createElement("div",{className:c.a.Top},e.examples.map((function(e,t){return a.a.createElement("button",{key:t,onClick:function(){return u(e)}}," Example ",t," ")}))),a.a.createElement(l.a,{mode:"python",theme:"cobalt",onChange:u,value:o,height:"100%",width:"100%"}),a.a.createElement("div",{className:c.a.Bottom},a.a.createElement("button",{onClick:function(){return e.onLogParseTree(o)}}," Log parse tree "),a.a.createElement("button",{onClick:function(){return e.onLogLexerOutput(o)}}," Log tokens "),a.a.createElement("button",{onClick:function(){return e.onSubmit(o)}}," Run ")))});u.defaultProps={examples:["123","hello world"]},t.a=u},36:function(e,t,r){"use strict";var n=r(1),s=r(2),a=r(8),o=r(14),c=r(7),i=r(5),l=r(3),u=r(4),p=function(){function e(){Object(n.a)(this,e)}return Object(s.a)(e,[{key:"findCellsReferenced",value:function(e){return[]}},{key:"unParse",value:function(e){throw Error("Not implemented ".concat(this.constructor.name,".unParse."))}}]),e}(),f=function(e){function t(e,r){var s;return Object(n.a)(this,t),(s=Object(i.a)(this,Object(l.a)(t).call(this))).left=e,s.right=r,s}return Object(u.a)(t,e),Object(s.a)(t,[{key:"findCellsReferenced",value:function(e){return this.left.findCellsReferenced(e).concat(this.right.findCellsReferenced(e))}},{key:"unParse",value:function(e){return"( "+this.left.unParse(e)+" "+this.symbol+" "+this.right.unParse(e)+" )"}}]),t}(p),h=function(e){function t(){var e,r;Object(n.a)(this,t);for(var s=arguments.length,a=new Array(s),o=0;o<s;o++)a[o]=arguments[o];return(r=Object(i.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(a)))).symbol="+",r}return Object(u.a)(t,e),Object(s.a)(t,[{key:"exec",value:function(e){return this.left.exec(e)+this.right.exec(e)}}]),t}(f),b=function(e){function t(){var e,r;Object(n.a)(this,t);for(var s=arguments.length,a=new Array(s),o=0;o<s;o++)a[o]=arguments[o];return(r=Object(i.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(a)))).symbol="-",r}return Object(u.a)(t,e),Object(s.a)(t,[{key:"exec",value:function(e){return this.left.exec(e)-this.right.exec(e)}}]),t}(f),m=function(e){function t(){var e,r;Object(n.a)(this,t);for(var s=arguments.length,a=new Array(s),o=0;o<s;o++)a[o]=arguments[o];return(r=Object(i.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(a)))).symbol="+",r}return Object(u.a)(t,e),Object(s.a)(t,[{key:"exec",value:function(e){return this.left.exec(e)*this.right.exec(e)}}]),t}(f),y=function(e){function t(){var e,r;Object(n.a)(this,t);for(var s=arguments.length,a=new Array(s),o=0;o<s;o++)a[o]=arguments[o];return(r=Object(i.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(a)))).symbol="/",r}return Object(u.a)(t,e),Object(s.a)(t,[{key:"exec",value:function(e){return this.left.exec(e)/this.right.exec(e)}}]),t}(f),v=function(e){function t(e){var r;return Object(n.a)(this,t),(r=Object(i.a)(this,Object(l.a)(t).call(this))).value=e.value,r.type=e.type,r.text=e.text,r.offset=e.offset,r.linebreaks=e.linebreaks,r.line=e.line,r.col=e.col,r}return Object(u.a)(t,e),Object(s.a)(t,[{key:"exec",value:function(){return this.value}},{key:"getErrorLineCol",value:function(){return[this.col,this.line]}},{key:"unParse",value:function(e){return this.text}}]),t}(p),d=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"unParse",value:function(e){return this.value.toString()}}]),t}(v),O=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"exec",value:function(e){return-this.operand.exec(e)}}]),t}(function(e){function t(e){var r;return Object(n.a)(this,t),(r=Object(i.a)(this,Object(l.a)(t).call(this))).operand=e,r}return Object(u.a)(t,e),Object(s.a)(t,[{key:"findCellsReferenced",value:function(e){return this.operand.findCellsReferenced(e)}}]),t}(p)),_=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(u.a)(t,e),t}(v),j=function(e){function t(e,r){var s;return Object(n.a)(this,t),(s=Object(i.a)(this,Object(l.a)(t).call(this))).identifier=new _(e),s.args=r,s}return Object(u.a)(t,e),Object(s.a)(t,[{key:"exec",value:function(e){e.getFunctionAst(this.identifier)}}]),t}(p),x=function(e){function t(e){var r;return Object(n.a)(this,t),(r=Object(i.a)(this,Object(l.a)(t).call(this,e))).identifier=e.value,r}return Object(u.a)(t,e),Object(s.a)(t,[{key:"exec",value:function(e){return e.getVarByName(this.identifier).value}}]),t}(v),g=function(e){function t(e,r){var s;return Object(n.a)(this,t),(s=Object(i.a)(this,Object(l.a)(t).call(this))).cell1=e,s.cell2=r,s}return Object(u.a)(t,e),Object(s.a)(t,[{key:"exec",value:function(e){return e.getCellsByRange(this.cell1,this.cell2).map((function(e){return e.value}))}},{key:"findCellsReferenced",value:function(e){return e.getCellsByRange(this.cell1,this.cell2)}}]),t}(p),k=function(e){function t(e){var r;return Object(n.a)(this,t),(r=Object(i.a)(this,Object(l.a)(t).call(this,e))).x=e.value.x,r.y=e.value.y,r}return Object(u.a)(t,e),Object(s.a)(t,[{key:"exec",value:function(e){return e.getCell(this.x,this.y).value}},{key:"findCellsReferenced",value:function(e){return[e.getCell(this.x,this.y)]}}]),t}(v),w=r(31),E=r.n(w),C=function(e){function t(e,r){var s;return Object(n.a)(this,t),(s=Object(i.a)(this,Object(l.a)(t).call(this))).x=e,s.y=r,s}return Object(u.a)(t,e),Object(s.a)(t,[{key:"exec",value:function(e){var t=this.x.exec(e),r=this.y.exec(e);return e.getCell(t,r).value}},{key:"unParse",value:function(e){var t=this.x.exec(e),r=this.y.exec(e);return e.getCell(t,r).label}}]),t}(p),$=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"exec",value:function(e){if(this.left instanceof x)e.setVariable(this.left.value,this.right.exec(e));else{if(!(this.left instanceof k||this.left instanceof C))throw new a.UserError("Assign not to variable");var t,r;this.left instanceof k?(t=this.left.x,r=this.left.y):(t=this.left.x.exec(e),r=this.left.y.exec(e));var n=E.a.cloneDeep(this.right),s={ast:n};!function e(t,r){for(var n in t)if(t.hasOwnProperty(n))if(t[n]instanceof x){var s=r.getVarByName(t[n].identifier).value;t[n]=new d({value:s})}else t[n]instanceof p&&e(t[n],r)}(s,e);var o="="+(n=s.ast).unParse(e);e.setCell(t,r,o)}}}]),t}(f);var S=function(e){function t(e,r){var s;return Object(n.a)(this,t),(s=Object(i.a)(this,Object(l.a)(t).call(this))).condition=e,s.block=r,s}return Object(u.a)(t,e),Object(s.a)(t,[{key:"exec",value:function(e){for(;this.condition.exec(e);)this.block.exec(e)}}]),t}(p),A=function(e){function t(e,r,s){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(l.a)(t).call(this))).condition=e,a.block=r,a.elseBlock=s,a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"exec",value:function(e){this.condition.exec(e)?this.block.exec(e):null!==this.elseBlock&&this.elseBlock.exec(e)}}]),t}(p),P=function(e){function t(e){var r;return Object(n.a)(this,t),(r=Object(i.a)(this,Object(l.a)(t).call(this))).list=e,r}return Object(u.a)(t,e),Object(s.a)(t,[{key:"exec",value:function(e){var t=!0,r=!1,n=void 0;try{for(var s,a=this.list[Symbol.iterator]();!(t=(s=a.next()).done);t=!0){s.value.exec(e)}}catch(o){r=!0,n=o}finally{try{t||null==a.return||a.return()}finally{if(r)throw n}}}}]),t}(p),q=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"exec",value:function(e){return this.left.exec(e)===this.right.exec(e)}}]),t}(f),D=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"exec",value:function(e){return this.left.exec(e)>=this.right.exec(e)}}]),t}(f),B=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"exec",value:function(e){return this.left.exec(e)<=this.right.exec(e)}}]),t}(f),I=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"exec",value:function(e){return this.left.exec(e)<this.right.exec(e)}}]),t}(f),M=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"exec",value:function(e){return this.left.exec(e)>this.right.exec(e)}}]),t}(f),L=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"exec",value:function(e){return this.left.exec(e)!==this.right.exec(e)}}]),t}(f),R=function(e){function t(e,r,s){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(l.a)(t).call(this))).identifier=new _(e),a.args=r,a.block=s,a}return Object(u.a)(t,e),t}(p),U=function(e){function t(e,r){var s;return Object(n.a)(this,t),(s=Object(i.a)(this,Object(l.a)(t).call(this))).identifier=e,s.referenced=r,s}return Object(u.a)(t,e),t}(p);function N(e){var t=Object(c.a)(e,3),r=t[0],n=(t[1],t[2]);return new h(r,n)}function T(e){var t=Object(c.a)(e,3),r=t[0],n=(t[1],t[2]);return new b(r,n)}function W(e){var t=Object(c.a)(e,3),r=t[0],n=(t[1],t[2]);return new m(r,n)}function K(e){var t=Object(c.a)(e,3),r=t[0],n=(t[1],t[2]);return new y(r,n)}function F(e){var t=Object(c.a)(e,1)[0];return new d(t)}function V(e){var t=Object(c.a)(e,2),r=(t[0],t[1]);return new O(r)}function z(e){var t=Object(c.a)(e,3),r=t[0],n=(t[1],t[2]);return new j(r,n)}function Z(e){var t=Object(c.a)(e,3),r=t[0],n=(t[1],t[2]);return new q(r,n)}function G(e){var t=Object(c.a)(e,3),r=t[0],n=(t[1],t[2]);return new D(r,n)}function J(e){var t=Object(c.a)(e,3),r=t[0],n=(t[1],t[2]);return new B(r,n)}function H(e){var t=Object(c.a)(e,3),r=t[0],n=(t[1],t[2]);return new I(r,n)}function Q(e){var t=Object(c.a)(e,3),r=t[0],n=(t[1],t[2]);return new M(r,n)}function X(e){var t=Object(c.a)(e,3),r=t[0],n=(t[1],t[2]);return new L(r,n)}function Y(e){var t=Object(c.a)(e,1)[0];return new x(t)}function ee(e){var t=Object(c.a)(e,3),r=t[0],n=(t[1],t[2]);return new g(r,n)}function te(e){var t=Object(c.a)(e,2),r=t[0],n=t[1],s=[r],a=!0,o=!1,i=void 0;try{for(var l,u=n[Symbol.iterator]();!(a=(l=u.next()).done);a=!0){var p=l.value;s.push(p[0])}}catch(f){o=!0,i=f}finally{try{a||null==u.return||u.return()}finally{if(o)throw i}}return new P(s)}function re(e){var t=Object(c.a)(e,3),r=t[0],n=(t[1],t[2]);return new $(r,n)}function ne(){return[]}function se(e){var t=Object(c.a)(e,1)[0];return new k(t)}function ae(e){var t=Object(c.a)(e,5),r=(t[0],t[1]),n=(t[2],t[3]);t[4];return new C(r,n)}function oe(e){var t=Object(c.a)(e,4),r=t[0],n=(t[1],t[2],t[3]);return new U(r,n)}var ce=r(22),ie=r(32),le=r.n(ie);var ue={ws:/[ \t\u00A0\u1680\u2000-\u200a\u2028\u2029\u202f\u3000]+/,end:{match:/\n/,lineBreaks:!0},cell:{match:/[a-zA-Z]+[0-9]+/,value:function(e){return function(e){for(var t=function(e){var t=/([a-zA-Z]+)([0-9]+)/.exec(e);return[t[1],t[2]]}(e),r=Object(c.a)(t,2),n=r[0],s=r[1],a=parseInt(s)-1,o=0,i=0;i<n.length;i++)o*="Z".charCodeAt(0)-"A".charCodeAt(0)+1,o+=n[i].charCodeAt(0)-"A".charCodeAt(0);return{x:o,y:a}}(e)}},identifier:{match:/[a-zA-Z]+/,type:ce.keywords({kwIf:"if",kwWhile:"while",kwFor:"for",kwElse:"else",kwDef:"def",kwReturn:"return"})},ampersand:"&",dot:".",lparen:"(",rparen:")",lsquare:"[",rsquare:"]",plus:"+",asterisk:"*",slash:"/",minus:"-",semicolon:";",colon:":",equal:"==",greaterEqual:">=",lessEqual:"<=",less:"<",greater:">",notEqual:"!=",assign:"=",string:/".*?"/,number:{match:/[1-9][0-9]*(?:,[0-9]*)?|0(?:\.[0-9]+)?/,value:function(e){return parseFloat(e)}}},pe=new le.a(ce.compile(ue),"ws","end");function fe(e){return e[0]}var he={Lexer:pe,ParserRules:[{name:"formulaEntry",symbols:["sum"]},{name:"expr",symbols:["comparison"],postprocess:fe},{name:"comparison",symbols:["sum"],postprocess:fe},{name:"comparison",symbols:["sum",pe.has("equal")?{type:"equal"}:equal,"sum"],postprocess:Z},{name:"comparison",symbols:["sum",pe.has("greaterEqual")?{type:"greaterEqual"}:greaterEqual,"sum"],postprocess:G},{name:"comparison",symbols:["sum",pe.has("lessEqual")?{type:"lessEqual"}:lessEqual,"sum"],postprocess:J},{name:"comparison",symbols:["sum",pe.has("less")?{type:"less"}:less,"sum"],postprocess:H},{name:"comparison",symbols:["sum",pe.has("greater")?{type:"greater"}:greater,"sum"],postprocess:Q},{name:"comparison",symbols:["sum",pe.has("notEqual")?{type:"notEqual"}:notEqual,"sum"],postprocess:X},{name:"sum",symbols:["product"],postprocess:fe},{name:"sum",symbols:["sum",pe.has("plus")?{type:"plus"}:plus,"product"],postprocess:N},{name:"sum",symbols:["sum",pe.has("minus")?{type:"minus"}:minus,"product"],postprocess:T},{name:"product",symbols:["primary"],postprocess:fe},{name:"product",symbols:["product",pe.has("asterisk")?{type:"asterisk"}:asterisk,"primary"],postprocess:W},{name:"product",symbols:["product",pe.has("slash")?{type:"slash"}:slash,"primary"],postprocess:K},{name:"primary",symbols:[pe.has("lparen")?{type:"lparen"}:lparen,"expr",pe.has("rparen")?{type:"rparen"}:rparen],postprocess:function(e){return e[1]}},{name:"primary",symbols:[pe.has("number")?{type:"number"}:number],postprocess:F},{name:"primary",symbols:["variable"],postprocess:fe},{name:"primary",symbols:["function_call"],postprocess:fe},{name:"primary",symbols:["range"],postprocess:fe},{name:"primary",symbols:["cell"],postprocess:fe},{name:"primary",symbols:[pe.has("minus")?{type:"minus"}:minus,"primary"],postprocess:V},{name:"primary",symbols:[pe.has("lsquare")?{type:"lsquare"}:lsquare,"sum",pe.has("semicolon")?{type:"semicolon"}:semicolon,"sum",pe.has("rsquare")?{type:"rsquare"}:rsquare],postprocess:ae},{name:"cell",symbols:[pe.has("cell")?{type:"cell"}:cell],postprocess:se},{name:"variable",symbols:[pe.has("identifier")?{type:"identifier"}:identifier],postprocess:Y},{name:"function_call",symbols:[pe.has("identifier")?{type:"identifier"}:identifier,pe.has("lparen")?{type:"lparen"}:lparen,"args",pe.has("rparen")?{type:"rparen"}:rparen],postprocess:z},{name:"function_call",symbols:[pe.has("kwIf")?{type:"kwIf"}:kwIf,pe.has("lparen")?{type:"lparen"}:lparen,"args",pe.has("rparen")?{type:"rparen"}:rparen],postprocess:z},{name:"args$ebnf$1",symbols:[]},{name:"args$ebnf$1$subexpression$1",symbols:[pe.has("semicolon")?{type:"semicolon"}:semicolon,"expr"]},{name:"args$ebnf$1",symbols:["args$ebnf$1","args$ebnf$1$subexpression$1"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"args",symbols:["expr","args$ebnf$1"],postprocess:te},{name:"args",symbols:[],postprocess:ne},{name:"range",symbols:["cell",pe.has("colon")?{type:"colon"}:colon,"cell"],postprocess:ee},{name:"entry$ebnf$1",symbols:[]},{name:"entry$ebnf$1$subexpression$1",symbols:[pe.has("end")?{type:"end"}:end]},{name:"entry$ebnf$1",symbols:["entry$ebnf$1","entry$ebnf$1$subexpression$1"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"entry$ebnf$2",symbols:[]},{name:"entry$ebnf$2$subexpression$1",symbols:[pe.has("end")?{type:"end"}:end]},{name:"entry$ebnf$2",symbols:["entry$ebnf$2","entry$ebnf$2$subexpression$1"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"entry",symbols:["entry$ebnf$1","code","entry$ebnf$2"],postprocess:function(e){return[e[1]]}},{name:"code$ebnf$1",symbols:[]},{name:"code$ebnf$1$subexpression$1",symbols:["statement"]},{name:"code$ebnf$1",symbols:["code$ebnf$1","code$ebnf$1$subexpression$1"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"code",symbols:["statement","code$ebnf$1"],postprocess:te},{name:"statement",symbols:["expr","ends"],postprocess:fe},{name:"statement",symbols:["reference"],postprocess:fe},{name:"statement",symbols:["assigment","ends"],postprocess:fe},{name:"statement",symbols:["blockStatement"],postprocess:fe},{name:"blockStatement",symbols:[pe.has("kwWhile")?{type:"kwWhile"}:kwWhile,"expr","ends","block"],postprocess:function(e){var t=Object(c.a)(e,4),r=t[1],n=t[3];return new S(r,n)}},{name:"blockStatement$ebnf$1$subexpression$1",symbols:["else"]},{name:"blockStatement$ebnf$1",symbols:["blockStatement$ebnf$1$subexpression$1"],postprocess:fe},{name:"blockStatement$ebnf$1",symbols:[],postprocess:function(e){return null}},{name:"blockStatement",symbols:[pe.has("kwIf")?{type:"kwIf"}:kwIf,"expr","ends","block","blockStatement$ebnf$1"],postprocess:function(e){var t=Object(c.a)(e,5),r=t[1],n=t[3],s=t[4];return new A(r,n,s)}},{name:"blockStatement",symbols:[pe.has("kwDef")?{type:"kwDef"}:kwDef,pe.has("identifier")?{type:"identifier"}:identifier,pe.has("lparen")?{type:"lparen"}:lparen,"args",pe.has("rparen")?{type:"rparen"}:rparen,"ends","block"],postprocess:function(e){var t=Object(c.a)(e,7),r=(t[0],t[1]),n=(t[2],t[3]),s=(t[4],t[5],t[6]);return new R(r,n,s)}},{name:"else",symbols:[pe.has("kwElse")?{type:"kwElse"}:kwElse,"ends","block"],postprocess:function(e){return Object(c.a)(e,3)[2]}},{name:"assigment",symbols:["variable",pe.has("assign")?{type:"assign"}:assign,"expr"],postprocess:re},{name:"assigment",symbols:["cell",pe.has("assign")?{type:"assign"}:assign,"expr"],postprocess:re},{name:"block",symbols:[pe.has("indent")?{type:"indent"}:indent,"code",pe.has("dedent")?{type:"dedent"}:dedent],postprocess:function(e){return Object(c.a)(e,2)[1]}},{name:"ends$ebnf$1$subexpression$1",symbols:[pe.has("end")?{type:"end"}:end]},{name:"ends$ebnf$1",symbols:["ends$ebnf$1$subexpression$1"]},{name:"ends$ebnf$1$subexpression$2",symbols:[pe.has("end")?{type:"end"}:end]},{name:"ends$ebnf$1",symbols:["ends$ebnf$1","ends$ebnf$1$subexpression$2"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"ends",symbols:["ends$ebnf$1"],postprocess:null},{name:"reference",symbols:[pe.has("identifier")?{type:"identifier"}:identifier,pe.has("assign")?{type:"assign"}:assign,pe.has("ampersand")?{type:"ampersand"}:ampersand,"range"],postprocess:oe},{name:"reference",symbols:[pe.has("identifier")?{type:"identifier"}:identifier,pe.has("assign")?{type:"assign"}:assign,pe.has("ampersand")?{type:"ampersand"}:ampersand,"cell"],postprocess:oe}],ParserStart:"entry"};function be(e){return e[0]}var me,ye,ve,de,Oe,_e={Lexer:pe,ParserRules:[{name:"formulaEntry",symbols:["sum"]},{name:"expr",symbols:["comparison"],postprocess:be},{name:"comparison",symbols:["sum"],postprocess:be},{name:"comparison",symbols:["sum",pe.has("equal")?{type:"equal"}:equal,"sum"],postprocess:Z},{name:"comparison",symbols:["sum",pe.has("greaterEqual")?{type:"greaterEqual"}:greaterEqual,"sum"],postprocess:G},{name:"comparison",symbols:["sum",pe.has("lessEqual")?{type:"lessEqual"}:lessEqual,"sum"],postprocess:J},{name:"comparison",symbols:["sum",pe.has("less")?{type:"less"}:less,"sum"],postprocess:H},{name:"comparison",symbols:["sum",pe.has("greater")?{type:"greater"}:greater,"sum"],postprocess:Q},{name:"comparison",symbols:["sum",pe.has("notEqual")?{type:"notEqual"}:notEqual,"sum"],postprocess:X},{name:"sum",symbols:["product"],postprocess:be},{name:"sum",symbols:["sum",pe.has("plus")?{type:"plus"}:plus,"product"],postprocess:N},{name:"sum",symbols:["sum",pe.has("minus")?{type:"minus"}:minus,"product"],postprocess:T},{name:"product",symbols:["primary"],postprocess:be},{name:"product",symbols:["product",pe.has("asterisk")?{type:"asterisk"}:asterisk,"primary"],postprocess:W},{name:"product",symbols:["product",pe.has("slash")?{type:"slash"}:slash,"primary"],postprocess:K},{name:"primary",symbols:[pe.has("lparen")?{type:"lparen"}:lparen,"expr",pe.has("rparen")?{type:"rparen"}:rparen],postprocess:function(e){return e[1]}},{name:"primary",symbols:[pe.has("number")?{type:"number"}:number],postprocess:F},{name:"primary",symbols:["variable"],postprocess:be},{name:"primary",symbols:["function_call"],postprocess:be},{name:"primary",symbols:["range"],postprocess:be},{name:"primary",symbols:["cell"],postprocess:be},{name:"primary",symbols:[pe.has("minus")?{type:"minus"}:minus,"primary"],postprocess:V},{name:"primary",symbols:[pe.has("lsquare")?{type:"lsquare"}:lsquare,"sum",pe.has("semicolon")?{type:"semicolon"}:semicolon,"sum",pe.has("rsquare")?{type:"rsquare"}:rsquare],postprocess:ae},{name:"cell",symbols:[pe.has("cell")?{type:"cell"}:cell],postprocess:se},{name:"variable",symbols:[pe.has("identifier")?{type:"identifier"}:identifier],postprocess:Y},{name:"function_call",symbols:[pe.has("identifier")?{type:"identifier"}:identifier,pe.has("lparen")?{type:"lparen"}:lparen,"args",pe.has("rparen")?{type:"rparen"}:rparen],postprocess:z},{name:"function_call",symbols:[pe.has("kwIf")?{type:"kwIf"}:kwIf,pe.has("lparen")?{type:"lparen"}:lparen,"args",pe.has("rparen")?{type:"rparen"}:rparen],postprocess:z},{name:"args$ebnf$1",symbols:[]},{name:"args$ebnf$1$subexpression$1",symbols:[pe.has("semicolon")?{type:"semicolon"}:semicolon,"expr"]},{name:"args$ebnf$1",symbols:["args$ebnf$1","args$ebnf$1$subexpression$1"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"args",symbols:["expr","args$ebnf$1"],postprocess:te},{name:"args",symbols:[],postprocess:ne},{name:"range",symbols:["cell",pe.has("colon")?{type:"colon"}:colon,"cell"],postprocess:ee}],ParserStart:"formulaEntry"},je=function(){function e(){Object(n.a)(this,e),this.parser=new o.Parser(o.Grammar.fromCompiled(he))}return Object(s.a)(e,[{key:"feed",value:function(e){try{this.parser.feed(e)}catch(t){throw new a.UserError(t.message)}}},{key:"results",get:function(){try{return this.parser.results[0][0]}catch(e){return null}}}]),e}(),xe=function(){function e(){Object(n.a)(this,e),this.parser=new o.Parser(o.Grammar.fromCompiled(_e))}return Object(s.a)(e,[{key:"feed",value:function(e){try{this.parser.feed(e)}catch(t){throw new a.UserError("Syntax error")}}},{key:"results",get:function(){try{return this.parser.results[0][0]}catch(e){return null}}}]),e}(),ge=r(11),ke=function e(t){Object(n.a)(this,e),this.value=null,this.value=t},we=r(15),Ee=r(16),Ce=(r(47),r(6)),$e=(me=function(){function e(t,r,s){Object(n.a)(this,e),Object(we.a)(this,"formula",ye,this),Object(we.a)(this,"value",ve,this),Object(we.a)(this,"background",de,this),Object(we.a)(this,"error",Oe,this),this.ast=null,this.observers=[],this.subjects=[],this.x=t,this.y=r,this.label=s}return Object(s.a)(e,[{key:"unregisterFromAllSubjects",value:function(){var e=!0,t=!1,r=void 0;try{for(var n,s=this.subjects[Symbol.iterator]();!(e=(n=s.next()).done);e=!0){n.value._unregisterObserver(this)}}catch(a){t=!0,r=a}finally{try{e||null==s.return||s.return()}finally{if(t)throw r}}this.subjects=[]}},{key:"observe",value:function(e){e.observers.push(this),this.subjects.push(e)}},{key:"_unregisterObserver",value:function(e){var t=this.observers.indexOf(e);t===this.observers.length-1?this.observers.pop():this.observers[t]=this.observers.pop()}}]),e}(),ye=Object(Ee.a)(me.prototype,"formula",[Ce.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ve=Object(Ee.a)(me.prototype,"value",[Ce.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),de=Object(Ee.a)(me.prototype,"background",[Ce.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Oe=Object(Ee.a)(me.prototype,"error",[Ce.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),me),Se=function(){function e(t,r){Object(n.a)(this,e),this.funcitons={},this.x=t,this.y=r,this.cells=Array(r);for(var s=0;s<r;s++){this.cells[s]=Array(t);for(var a=Object(ge.b)(),o=0;o<t;o++){var c=a.next().value+(s+1).toString();this.cells[s][o]=new $e(o,s,c)}}this.variablesScopes=[{}]}return Object(s.a)(e,[{key:"setCell",value:function(e,t,r){var n=this.getCell(e,t);n.unregisterFromAllSubjects();try{Object(ge.a)(r)?this._setCellFormula(n,r):this._setCellValue(n,r),this.updateObservers(n),n.error=null}catch(s){if("UserError"!==s.name)throw s;n.error=s.message}}},{key:"_setCellFormula",value:function(e,t){e.formula=t;var r=new xe;r.feed(t.substring(1)),e.ast=r.results,e.value=e.ast.exec(this);var n=e.ast.findCellsReferenced(this),s=!0,a=!1,o=void 0;try{for(var c,i=n[Symbol.iterator]();!(s=(c=i.next()).done);s=!0){var l=c.value;e.observe(l)}}catch(u){a=!0,o=u}finally{try{s||null==i.return||i.return()}finally{if(a)throw o}}}},{key:"_setCellValue",value:function(e,t){var r=parseFloat(t);isNaN(r)?e.value=t:e.value=r,e.formula=null,e.ast=null}},{key:"getCellsByRange",value:function(e,t){var r=e.x,n=e.y,s=e.x,o=e.y;if(this.x<=r||this.y<=n)throw new a.UserError("No cell: ".concat(e));if(this.x<=s||this.y<=o)throw new a.UserError("No cell: ".concat(t));for(var c=[],i=n;i<=o;i++)for(var l=r;l<=s;l++)c.push(this.cells[i][l]);return c}},{key:"getCell",value:function(e,t){try{return this.cells[t][e]}catch(r){throw new a.UserError("No such cell")}}},{key:"updateObservers",value:function(e){var t=!0,r=!1,n=void 0;try{for(var s,a=Object(ge.c)(e)[Symbol.iterator]();!(t=(s=a.next()).done);t=!0){var o=s.value;o.value=o.ast.exec(this)}}catch(c){r=!0,n=c}finally{try{t||null==a.return||a.return()}finally{if(r)throw n}}}},{key:"getFunctionAst",value:function(e){if(!this.funcitons.hasOwnProperty(e))throw new a.UserError("No function: ".concat(e));return this.funcitons[e]}},{key:"setVariable",value:function(e,t){var r=this.variablesScopes[this.variablesScopes.length-1];try{this.getVarByName(e).value=t}catch(n){r[e]=new ke(t)}}},{key:"getVarByName",value:function(e){var t=this.variablesScopes[this.variablesScopes.length-1];if(t.hasOwnProperty(e))return t[e];throw new a.UserError("No variable: ".concat(e))}}]),e}();r.d(t,"a",(function(){return Ae}));var Ae=function(){function e(t,r){Object(n.a)(this,e),this.env=new Se(t,r)}return Object(s.a)(e,[{key:"onCellSet",value:function(e,t,r){this.env.setCell(e,t,r)}},{key:"run",value:function(e){if(""!==e)try{var t=new je;t.feed(e),t.results.exec(this.env)}catch(r){if("UserError"!==r.name)throw r;console.log(r.message)}}},{key:"logParseTree",value:function(e){try{var t=new je;t.feed(e),console.log(t.results)}catch(r){if("UserError"!==r.name)throw r;console.log(r.message)}}},{key:"logLexerOutput",value:function(e){try{pe.reset(e);for(var t=[],r=pe.next();void 0!==r;)t.push(r),r=pe.next();console.log(t)}catch(n){if("UserError"!==n.name)throw n;console.log(n.message)}}},{key:"cells",get:function(){return this.env.cells}}]),e}()},39:function(e,t,r){e.exports=r(474)},44:function(e,t,r){},474:function(e,t,r){"use strict";r.r(t);var n=r(0),s=r.n(n),a=r(12),o=r.n(a),c=(r(44),r(29));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(s.a.createElement(c.a,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},8:function(e,t,r){"use strict";r.r(t),r.d(t,"UserError",(function(){return l}));var n=r(1),s=r(5),a=r(3),o=r(18),c=r(4),i=r(37),l=function(e){function t(){var e,r;Object(n.a)(this,t);for(var c=arguments.length,i=new Array(c),l=0;l<c;l++)i[l]=arguments[l];return(r=Object(s.a)(this,(e=Object(a.a)(t)).call.apply(e,[this].concat(i)))).name="UserError",Error.captureStackTrace&&Error.captureStackTrace(Object(o.a)(r),t),r}return Object(c.a)(t,e),t}(Object(i.a)(Error))}},[[39,1,2]]]);
//# sourceMappingURL=main.08257337.chunk.js.map